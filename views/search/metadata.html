<% include ../add_ins/begin.ejs %>
<link rel="stylesheet" type="text/css" href="/stylesheets/search.css">
<% var metaitems = JSON.parse(metadata_items); %>

<% // sort keys %>


<script defer>
  var mi_local  = JSON.parse('<%- metadata_items %>');
</script>
<p class='title'>Search</p>
<% if (messages.success) { %>
	<div class="alert_flash_message_success"><%= messages.success %></div>
<% }else if(messages.fail){ %>
    <div class="alert_flash_message_fail"><%= messages.fail %></div>
<% } %>

<center><strong>Find Datasets by Metadata Name(s)</strong></center>
<a href='/search/search_index'>Back to Available Searches</a>
	  
      <!-- METADATA SEARCH by Name --><a name="metadata"></a>
<br><br>
<% if(metadata_search_type == 'byname'){ %>
    <div class='container'>
    <div class='row'>
    <div class="col-lg-12">
        <div id='metadata_search_div' class='well' style='width:100%'>
            <form id='metadata_search_form' name='' method='POST' action='/search/metadata_search_result' >	
                    
            
            <strong>Metadata -- Search by Name</strong> (limited by permissions)
            <br>
            Select Field(s) to Search:<br><br>
            <table border='0' style='width:100%'>
                
                <tr>            
                    <td style='padding:5px'>Primary:
                        <select id='field1_metadata_search'  data-style="btn-primary" name='search1_metadata-item'>
                            <option value='NONE'>select</option>						
                            <% for (i = 0; i < mkeys.length; i++) { %>	
                                <option class='' value='<%= mkeys[i] %>'><%= mkeys[i] %></option>
                            <% } %> 
                        </select>
                    </td>
                </tr>
                <tr>        
                    <td colspan='3' style='padding:5px'><div id='metadata_search_range_div1' class='display_none'></div></td>
                </tr>
                <tr style="border-bottom:1px solid black"><td colspan='100%'></td></tr>
                <tr> 
                    <td style='padding:5px'>Secondary: click to activate: <input id='search_metadata_activate_btn2' type='checkbox' value='activate' ></td>              
                    <td style='padding:5px'>		
                        
                        <select id='field2_metadata_search' class="selectpicker" data-style="btn-primary" name='search2_metadata-item' disabled='disabled' >
                            <option value='NONE' label=''></option>
                            <% for (i = 0; i < mkeys.length; i++) { %>	
                                <option class='' value='<%= mkeys[i] %>'><%= mkeys[i] %></option>
                            <% } %>
                        </select>
                    </td>
                </tr> 
                <tr>
                    <td colspan='3' style='padding:5px'><div id='metadata_search_range_div2' class='display_none'></div></td>
                </tr>
                <tr style="border-bottom:1px solid black"><td colspan='100%'></td></tr>
                <tr>    
                    <td style='padding:5px'>Tertiary: click checkbox to activate: <input id='search_metadata_activate_btn3' type='checkbox' value='activate' ></td>
                    <td></td>
                    <td style='padding:5px'>	
                        
                        <select id='field3_metadata_search' class="selectpicker" data-style="btn-primary" name='search3_metadata-item' disabled='disabled' >
                            <option value='NONE' label=''></option>
                            <% for (i = 0; i < mkeys.length; i++) { %>	
                                <option class='' value='<%= mkeys[i] %>'><%= mkeys[i] %></option>
                            <% } %>
                        </select>
                    </td>
                </tr>
                <tr>	
                    <td colspan='3' style='padding:5px'><div id='metadata_search_range_div3' class='display_none'></div></td>
                </tr>
                <tr><td>&nbsp;</td></tr>
                <tr>
                    
                    <td>    
                   
                           
                        <!--	<input id='search_metadata_btn' class='display_none' type='submit' value='Search Datasets' > -->
                            <button id='search_metadata_btn' class='btn btn-xs btn-primary' disabled='disabled' type='submit'>Search Datasets</button>
                            <input name='search_function'  type='hidden' value='search_metadata_all_datasets' >
                    </td>
                </tr>

            </table>
            </form>
    
        </div>
   </div>
  </div>
</div>        
<%}else{ %>
<div class='container'>
  <div class='row'>
    <div class="col-lg-12">
        TODO
    </div>
  </div>
</div>
<% } %>







	
<% include ../add_ins/end.ejs %>
<script type="text/javascript" src="/javascripts/global.js" defer></script>>
<script type="text/javascript" src="/javascripts/search.js" defer></script>>
</body>
</html>